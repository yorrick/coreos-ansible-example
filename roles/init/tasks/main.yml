---

- name: Install cloud config file
  template: src=user-data.yml dest=/var/lib/coreos-vagrant/vagrantfile-user-data
  sudo: yes

- name: Wait for cloud config to be applied
  wait_for: port=4001 delay=10

- name: Test that etcd is running
  shell: "etcdctl set /message Hello && etcdctl rm /message"

- name: Test that fleet is running
  command: fleetctl list-machines
  register: fleet_machines
